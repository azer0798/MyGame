<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#4a148c">
    <title>ูุทุงุจูุฉ ุงูุฃููููุงุช ุงูุนุฑุจูุฉ - ุชุญุฏู ูุง ููุชูู</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>โ</text></svg>">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ุดุงุดุฉ ุงูุชุญููู -->
    <div id="loading-screen">
        <div class="loader"></div>
        <div class="loading-text">ุฌุงุฑู ุชุญููู ุงููุนุจุฉ...</div>
    </div>

    <!-- ุงูุชุทุจูู ุงูุฑุฆูุณู -->
    <div id="app">
        <!-- ุงูุดุฑูุท ุงูุนููู -->
        <div class="top-bar">
            <div class="player-info">
                <div class="player-stats">
                    <div class="stat-item">
                        <span class="stat-icon">โญ</span>
                        <span id="total-score" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">๐ช</span>
                        <span id="total-coins" class="stat-value">500</span>
                    </div>
                </div>
            </div>
            <div class="level-badge">
                <span id="current-level">ุงููุณุชูู 1</span>
                <span id="player-xp">XP: 0/100</span>
            </div>
        </div>

        <!-- ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ -->
        <div id="main-menu">
            <h1 class="game-title">ูุทุงุจูุฉ ุงูุฃููููุงุช ุงูุนุฑุจูุฉ</h1>
            <p class="game-subtitle">ุชุญุฏู ูุง ููุชูู - ุงุณุชูุชุน ุจุชุฌุฑุจุฉ ุนุฑุจูุฉ ุฃุตููุฉ</p>
            
            <div class="menu-grid">
                <div class="menu-card" onclick="startGame()">
                    <span class="card-icon">๐ฎ</span>
                    <h3 class="card-title">ุงุจุฏุฃ ุงููุนุจ</h3>
                    <p class="card-desc">ุงุณุชูุฑ ูู ุญูุซ ุชูููุช ุฃู ุงุจุฏุฃ ูุณุชูู ุฌุฏูุฏุงู</p>
                </div>
                
                <div class="menu-card" onclick="showLevels()">
                    <span class="card-icon">๐</span>
                    <h3 class="card-title">ุงููุณุชููุงุช</h3>
                    <p class="card-desc">ุงุฎุชุฑ ูู ุจูู 100+ ูุณุชูู ูุชููุน</p>
                </div>
                
                <div class="menu-card" onclick="showShop()">
                    <span class="card-icon">๐</span>
                    <h3 class="card-title">ุงููุชุฌุฑ</h3>
                    <p class="card-desc">ุงุดุชุฑู ุนูุงุตุฑ ูุณุงุนุฏุฉ ูููุงูุขุช ุฎุงุตุฉ</p>
                </div>
                
                <div class="menu-card" onclick="showProfile()">
                    <span class="card-icon">๐ค</span>
                    <h3 class="card-title">ูููู</h3>
                    <p class="card-desc">ุดุงูุฏ ุฅูุฌุงุฒุงุชู ูุฅุญุตุงุฆูุงุชู</p>
                </div>
            </div>

            <div class="menu-buttons">
                <button class="game-btn btn-primary btn-large" onclick="startGame()">
                    <span>๐ฎ</span> ุงุจุฏุฃ ุงููุนุจ
                </button>
                <button class="game-btn btn-secondary" onclick="showSettings()">
                    <span>โ๏ธ</span> ุงูุฅุนุฏุงุฏุงุช
                </button>
                <button class="game-btn btn-secondary" onclick="showTutorial()">
                    <span>๐</span> ููููุฉ ุงููุนุจ
                </button>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุงููุนุจุฉ -->
        <div id="game-screen">
            <div class="game-header">
                <div class="level-info">
                    <h2 class="level-name" id="level-name">ุณูู ุงููุฏููุฉ</h2>
                    <p class="level-desc" id="level-desc">ุงููุณุชูู 1 ูู 100</p>
                </div>
                
                <div class="game-meta">
                    <div class="meta-item">
                        <div class="meta-value" id="moves-left">25</div>
                        <div class="meta-label">ุชุญุฑูุงุช</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-value" id="current-score">0</div>
                        <div class="meta-label">ููุงุท</div>
                    </div>
                </div>
            </div>

            <div class="game-content">
                <!-- ููุญุฉ ุงููุนุจุฉ -->
                <div class="game-board-container">
                    <div id="game-board"></div>
                    
                    <div class="level-progress">
                        <div class="progress-header">
                            <span>ุชูุฏู ุงููุณุชูู</span>
                            <span id="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- ุงูุดุฑูุท ุงูุฌุงูุจู -->
                <div class="game-sidebar">
                    <!-- ุงูุฃูุฏุงู -->
                    <div class="sidebar-section">
                        <h3 class="section-title">๐ฏ ุฃูุฏุงู ุงููุณุชูู</h3>
                        <div class="goals-list" id="goals-list"></div>
                    </div>

                    <!-- ุงูุนูุงุตุฑ ุงููุณุงุนุฏุฉ -->
                    <div class="sidebar-section">
                        <h3 class="section-title">โจ ุงูุนูุงุตุฑ ุงููุณุงุนุฏุฉ</h3>
                        <div class="powerups-grid" id="powerups-grid"></div>
                    </div>

                    <!-- ุงูููุงู ุงูููููุฉ -->
                    <div class="sidebar-section">
                        <h3 class="section-title">๐ ููุงู ุงูููู</h3>
                        <div class="daily-quests" id="daily-quests"></div>
                    </div>
                </div>
            </div>

            <!-- ุฃุฒุฑุงุฑ ุงูุชุญูู -->
            <div class="game-footer">
                <button class="game-btn btn-secondary" onclick="showHint()">
                    <span>๐ก</span> ุชูููุญ
                </button>
                <button class="game-btn btn-secondary" onclick="shuffleBoard()">
                    <span>๐</span> ุฅุนุงุฏุฉ ุชุฑุชูุจ
                </button>
                <button class="game-btn btn-primary" onclick="pauseGame()">
                    <span>โธ๏ธ</span> ุฅููุงู ูุคูุช
                </button>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุงููุชุฌุฑ -->
        <div id="shop-screen">
            <h2 class="popup-title">๐ ูุชุฌุฑ ุงููุนุจุฉ</h2>
            <div class="shop-grid" id="shop-items"></div>
            <div class="popup-buttons">
                <button class="game-btn btn-primary" onclick="showMainMenu()">
                    <span>๐</span> ุงูุนูุฏุฉ
                </button>
            </div>
        </div>

        <!-- ุดุงุดุฉ ุงูููู ุงูุดุฎุตู -->
        <div id="profile-screen">
            <div class="profile-header">
                <div class="profile-avatar" id="player-avatar">๐ค</div>
                <div>
                    <h2 id="player-name">ุงููุงุนุจ</h2>
                    <p id="player-rank">ุงูุฑุชุจุฉ: ูุจุชุฏุฆ</p>
                </div>
            </div>
            
            <div class="profile-stats" id="player-stats"></div>
            
            <h3 class="section-title">๐ ุงูุฅูุฌุงุฒุงุช</h3>
            <div class="achievement-grid" id="achievements-grid"></div>
            
            <div class="popup-buttons">
                <button class="game-btn btn-primary" onclick="showMainMenu()">
                    <span>๐</span> ุงูุนูุฏุฉ
                </button>
            </div>
        </div>
    </div>

    <!-- ุงูุดุงุดุงุช ุงูููุจุซูุฉ -->
    <!-- ูุงูุฐุฉ ุงูุฅููุงู ุงููุคูุช -->
    <div id="pause-popup" class="popup-overlay">
        <div class="popup-content">
            <h2 class="popup-title">โธ๏ธ ุงููุนุจุฉ ูุชูููุฉ</h2>
            <div class="popup-buttons">
                <button class="game-btn btn-primary" onclick="resumeGame()">
                    <span>โถ๏ธ</span> ุงุณุชูุฑุงุฑ
                </button>
                <button class="game-btn btn-secondary" onclick="restartLevel()">
                    <span>๐</span> ุฅุนุงุฏุฉ
                </button>
                <button class="game-btn btn-secondary" onclick="showMainMenu()">
                    <span>๐</span> ุงููุงุฆูุฉ
                </button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงูููุฒ -->
    <div id="win-popup" class="popup-overlay">
        <div class="popup-content">
            <h2 class="popup-title">๐ ูุจุฑูู! ูุฒุช</h2>
            
            <div class="popup-stats">
                <div class="popup-stat">
                    <div class="stat-label">ุงูุชุญุฑูุงุช ุงููุชุจููุฉ</div>
                    <div id="win-moves" class="stat-value">0</div>
                </div>
                <div class="popup-stat">
                    <div class="stat-label">ุงูููุงุท ุงููุญููุฉ</div>
                    <div id="win-score" class="stat-value">0</div>
                </div>
                <div class="popup-stat">
                    <div class="stat-label">ุงูููุงูุฃุฉ</div>
                    <div id="win-bonus" class="stat-value">+0</div>
                </div>
            </div>

            <div class="rewards-container" id="level-rewards"></div>

            <div class="popup-buttons">
                <button class="game-btn btn-primary" onclick="nextLevel()">
                    <span>โก๏ธ</span> ุงููุณุชูู ุงูุชุงูู
                </button>
                <button class="game-btn btn-secondary" onclick="playAgain()">
                    <span>๐</span> ุฅุนุงุฏุฉ ุงููุนุจ
                </button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงูุฎุณุงุฑุฉ -->
    <div id="lose-popup" class="popup-overlay">
        <div class="popup-content">
            <h2 class="popup-title">๐ ุงูุชูุช ุงูุชุญุฑูุงุช</h2>
            <p class="popup-message">ูู ุชุญูู ุฌููุน ุงูุฃูุฏุงู ูู ุงูุชุญุฑูุงุช ุงููุชุงุญุฉ</p>
            
            <div class="popup-buttons">
                <button class="game-btn btn-primary" onclick="restartLevel()">
                    <span>๐</span> ุญุงูู ูุฑุฉ ุฃุฎุฑู
                </button>
                <button class="game-btn btn-secondary" onclick="showMainMenu()">
                    <span>๐</span> ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ
                </button>
                <button class="game-btn btn-secondary" onclick="useContinue()">
                    <span>โจ</span> ุงุณุชูุฑ ุจู 50 ุฐูุจ
                </button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงููุณุชููุงุช -->
    <div id="levels-popup" class="popup-overlay">
        <div class="popup-content">
            <h2 class="popup-title">๐ ุงุฎุชุฑ ูุณุชูู</h2>
            <div id="levels-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0;"></div>
            <div class="popup-buttons">
                <button class="game-btn btn-primary" onclick="closeLevels()">
                    <span>๐</span> ุงูุนูุฏุฉ
                </button>
            </div>
        </div>
    </div>

    <!-- ุงูุชุญูู ุจุงูุตูุช -->
    <div class="audio-controls">
        <div class="audio-btn" onclick="toggleMusic()" id="music-btn">๐ต</div>
        <div class="audio-btn" onclick="toggleSound()" id="sound-btn">๐</div>
    </div>

    <!-- ูุคุดุฑ ุงูุณุญุจ (ููุฌูุงู) -->
    <div class="swipe-indicator">โฆ ุงุณุญุจ ููุชุญูู โจ</div>

    <!-- ููุทูุฉ ุนุฑุถ ุงููููุจู -->
    <div class="combo-display" id="combo-display"></div>

    <!-- ููุทูุฉ ุงูุฅุดุนุงุฑุงุช -->
    <div id="notification-area"></div>

    <script src="game.js"></script>
    <script>
        // ============================================
        // ููู Manifest ููุชุทุจูู ุงูุชูุฏูู (PWA)
        // ============================================
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').then(
                    registration => {
                        console.log('ServiceWorker registered:', registration.scope);
                    },
                    error => {
                        console.log('ServiceWorker registration failed:', error);
                    }
                );
            });
        }

        // ============================================
        // ุฏุนู ุชุซุจูุช ุงูุชุทุจูู
        // ============================================
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // ุนุฑุถ ุฒุฑ ุงูุชุซุจูุช
            const installBtn = document.createElement('button');
            installBtn.textContent = '๐ฒ ุชุซุจูุช ุงูุชุทุจูู';
            installBtn.className = 'game-btn btn-primary';
            installBtn.style.position = 'fixed';
            installBtn.style.bottom = '20px';
            installBtn.style.left = '50%';
            installBtn.style.transform = 'translateX(-50%)';
            installBtn.style.zIndex = '1000';
            
            installBtn.onclick = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`User response: ${outcome}`);
                    deferredPrompt = null;
                    installBtn.remove();
                }
            };
            
            document.body.appendChild(installBtn);
            
            // ุฅุฎูุงุก ุงูุฒุฑ ุจุนุฏ 30 ุซุงููุฉ
            setTimeout(() => {
                if (installBtn.parentNode) {
                    installBtn.remove();
                }
            }, 30000);
        });
    </script>
</body>
</html>